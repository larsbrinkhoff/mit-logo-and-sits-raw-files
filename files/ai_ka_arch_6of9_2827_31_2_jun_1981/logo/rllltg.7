
MAKE 'CTR '0
MAKE 'EDITMODE 'NIL
MAKE 'LISPBREAK 'T

TO SETUP
1 TVSIZE 200
2 TURTLESIZE 400
END

TO LAP :DISTANCE :ANGLE :DELTA :FOLD
1 CLEARSCREEN
2 PENDOWN
3 MAKE "CTR" :FOLD
20 PENUP HOME
30 RIGHT ((360 / :FOLD) * :CTR)
40 PENDOWN
50 RPS :DISTANCE :ANGLE :DELTA
60 MAKE "CTR" :CTR - 1
70 IF EQUAL 0 :CTR THEN PENUP HOME STOP
99 GO 20
END

TO MPS
1 MAKE "DISTANCE" 100
2 MAKE "ANGLE" 120
3 MAKE "DELTA" 5
4 MAKE "CORNERS" "FALSE"
5 MAKE "FOLD" 1
6 MAKE "OFFSET" 0
10 CLEARSCREEN
11 PENDOWN
12 HIDETURTLE
110 MAKE "TEMP" CHAR .CTYI
120 IF EQUAL :TEMP "A" THEN PRINT "WHAT ANGLE ?" MAKE "ANGLE" TYPEIN GO 200
130 IF EQUAL :TEMP "P" THEN MAKE "A" :A + 1
132 IF EQUAL :TEMP "O" THEN MAKE "A" :A - 1
140 IF EQUAL :TEMP "$+$" THEN MAKE "FOLD" :FOLD + 1
142 IF EQUAL :TEMP "$-$" THEN MAKE "FOLD" :FOLD - 1
150 IF EQUAL :TEMP "$>$" THEN MAKE "DELTA" :DELTA + 1 GO 200
160 IF EQUAL :TEMP "$<$" THEN MAKE "DELTA" :DELTA - 1 GO 200
190 IF EQUAL :TEMP "." THEN STOP
199 GO 200
200 LAP :DISTANCE :ANGLE :DELTA :FOLD
299 GO 110
END

TO R
1 PENUP
2 HOME
3 PENDOWN
END

TO LPS :DISTANCE :ANGLE :DELTA
1 FORWARD :DISTANCE
2 LEFT :ANGLE
3 MAKE "DISTANCE" :DISTANCE - :DELTA
4 IF GREATERP 0 :DISTANCE THEN STOP
5 GO 1
END

TO RPS :DISTANCE :ANGLE :DELTA
1 FORWARD :DISTANCE
2 RIGHT :ANGLE
3 MAKE "DISTANCE" :DISTANCE - :DELTA
4 IF GREATERP 0 :DISTANCE THEN STOP
5 GO 1
END

TO LPOLYSPI :DISTANCE :ANGLE :DELTA
1 FORWARD :DISTANCE
2 LEFT :ANGLE
3 MAKE "DISTANCE" :DISTANCE + :DELTA
4 GO 1
END

TO RPOLYSPI :DISTANCE :ANGLE :DELTA
1 FORWARD :DISTANCE
2 RIGHT :ANGLE
3 MAKE "DISTANCE" :DISTANCE + :DELTA
4 GO 1
END

TO LINSPI :DISTANCE :ANGLE :DELTA
1 FORWARD :DISTANCE
2 LEFT :ANGLE
3 MAKE "ANGLE" :ANGLE + :DELTA
4 IF GREATERP :ANGLE 360 THEN MAKE "ANGLE" :ANGLE - 360
5 GO 1
END

TO RINSPI :DISTANCE :ANGLE :DELTA
1 FORWARD :DISTANCE
2 RIGHT :ANGLE
3 MAKE "ANGLE" :ANGLE + :DELTA
4 IF GREATERP :ANGLE 360 THEN MAKE "ANGLE" :ANGLE - 360
5 GO 1
END
