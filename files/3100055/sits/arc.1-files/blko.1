	.TITLE WHY THE HELL DOESN'T .BLKO WORK?
.INSRT SITS;SITSS SYMS
.INSRT SITS;SITMAC >

.=400
	.BLKW 40
PDL:
FILCAP:	0
FILBLK:	ASCIZ ^/THISSUCKS >/
NUMBLK:	4

GO:	MOV #PDL,P
	SAVE <#3400,#0,#<27*400+377>,#.CRWRT+1>
	$MAP
	SAVE <#-1,#0,#.CPYCP+10>
	$INVOK
	REST FILCAP
	SAVE <#0,#FILBLK,FILCAP>
	BIS #.FAAD,(P)
	$INVOK
	SAVE <#0,#FILBLK,FILCAP>
	BIS #.FAMU,(P)
	$INVOK
	CLR A
	MOV NUMBLK,D
MAKFIL:	SAVE <#BLKST,#-20000,FILCAP>
	$BLKO
	SOB D,MAKFIL
	SAVE <#0,#0,FILCAP>
	BIS #.FASP,(P)
	$INVOK
	MOV #11*400,A
	ADD FILCAP,A
	MOV NUMBLK,D
	CLR B
GETPAG:	SAVE <#3400,B,A,#.CRRD+1>
	$MAP
	INC B
	ADD #400,A
	SOB D,GETPAG
	MOV NUMBLK,B
	CLR F
FIXPAG:	MOV #4096.,E
	MOV #BLKST,D
WRTDT:	MOV F,(D)+
	INC F
	SOB E,WRTDT
	SAVE <#BLKST,#-20000,FILCAP>
	$BLKO
	MOV F,C
	ASL C
	MOV #4096.,E
	MOV F,B
	SUB #4096.,B
CHKLOP:	CMP B,(C)+
	BEQ .+4
BADMAP:	BPT
	INC B
	SOB E,CHKLOP
	SOB B,FIXPAG
	MOV #11*400+375,A
	MOV NUMBLK,D
DELPAG:	SAVE <A,A,A,.CRWRT+1>
	$MAP
	ADD #400,A
	SOB D,DELPAG
	SAVE <A,A,FILCAP>
	BIS #.DELCP,(P)
	$INVOK
GODPRO:	BPT
BLKST==160000
.END GO
