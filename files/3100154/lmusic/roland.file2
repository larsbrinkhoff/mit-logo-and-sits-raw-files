

TO MEMBERP :X :L
10 IF EMPTYP :L OUTPUT "FALSE"
20 IF :X=FIRST :L OUTPUT "TRUE"
30 MAKE "L" BUTFIRST :L GO 10
END

TO POSITION :X :LIST
10 LOCAL "Y"
20 MAKE "Y" 1
30 IF EMPTYP :LIST OUTPUT 0
40 IF :X=FIRST :LIST OUTPUT :Y
50 MAKE "Y" :Y+1
60 MAKE "LIST" BUTFIRST :LIST
70 GO 30
END

TO NTH :X :LIST
10 IF EMPTYP :LIST EXIT "LIST TOO SHORT"
20 IF :X=1 OUTPUT FIRST :LIST
30 MAKE "LIST" BUTFIRST :LIST
40 MAKE "X" :X-1
50 GO 10
END

TO INTERPRET :XX
10 LOCAL "X" "Y" "Z"
20 MAKE "X" :XX
25 MAKE "Y" :TUNEBASE
30 IF NUMBERP :X GO 1010
40 IF "*"=FIRST :X MAKE "Y" :Y-12 MAKE "X" BUTFIRST :X GO 40
50 IF EMPTYP :X GO 500
60 IF "/"=FIRST :X MAKE "X" BUTFIRST :X GO 500
70 IF "*"=FIRST :X MAKE "Y" :Y+12 MAKE "X" BUTFIRST :X GO 50
80 MAKE "Z" :Z&FIRST :X
90 MAKE "X" BUTFIRST :X
100 GO 50
500 IF NUMBERP :Z MAKE "Y" :Z+:Y GO 1000
505 IF EMPTYP :Z MAKE "Y" :LASTPITCH GO 1000
510 IF ":"=FIRST :Z MAKE "Y" :Y+SCALE BUTFIRST :Z GO 1000
520 IF "+"=LAST :Z MAKE "Y" :Y-:TUNEBASE+:LASTPITCH+BUTLAST :Z GO 1000
530 IF "-"=LAST :Z MAKE "Y" :Y-:TUNEBASE+:LASTPITCH-BUTLAST :Z GO 1000
531 IF :Z="REST" MAKE "Y" 0 GO 1000
532 I¯»Z{"BOOMÙH&¡ó¯®YE 1 GOÙX0aÒ¢ö≥g IF :˚OQG•ITCH" MAKEÙ¨¢A2 GO 1000
540 MAKE "Y" :Y+SCALE :Z
1000 IF EMPTYP :X MAKE "X" :LASTDURATION
1010 IF NUMBERP :X MAKE "LASTDURATION" :X OUTP˙µSãNTENCE :Y :X
1020 MAKE "Z" ""Ò¢ò∞g0 IF EMPTYP :X GO 2000
1040 IF ","=FIRST :X MAKE "X" BUTFIRST :X GO 2000
1050 MAKE "Z" :Z&FIRST :X MAKE "X" BUTFIRST :X GO 1030
2000 IF NOT NUMBERP :Z MAKE "Z" TEMPO :Z
2005 MAKE "LASTDURATION" :Z
2010 IF EMPTYP :X OUTPUT SENTENCE :Y :Z
2020 OUTPUT (SENTENCE ˜VP:µÙ¨)ÒQgD
TOÙ·¡ôE :XX
10 LOCAL "X" "Y" "˚Hê"ù¯520 MA˘qP"≥ÙH25 MAKE "XÙHX±
30 IF "#ÙOfAßT :X MAKE "Y" :Y+1 M¯2‚†E˚êB´˙ì ”© :X GO 30ÓÒM ìF "$"˜≥ ”©Ù¨ õ¯2‚†EY" :Yı¨PMÉKE "XÙH!U©˘êi‘A˜VGü 40
ˆçPIç "%"=LAST ˜VMÉ˘qP"ùAT" 1 MAKE "X" BUTLAST :X
50 IF NUMBERPÙ¨ è˘Ë∞a
55 IF "+"=LAST :X MAKE "X" :LASTSCALE+BUTLAST :XÙÁ†kˆäk6 IF ÙKQ=ôAST :X MAKE "X" :LAS˙î·¡ô¯´aU©˘êi‘A:X GOÙX070 MAKE "LASTS¯pfEE POSITION ˜V"áÙEA¯»#†ÉÙë75 IF :LASTSCALE=0 PRINT :XX EXIT " IS NOT IN THE SCALE"
80 IF 1=:NAT GO 100
82 IF NOT :Y=0 GO 100
85 IF MEMBERP :X :FLATS MAKE "Y" -1
90 IF MEMBERP :X :SHARPS MAKE "Y" 1
100 OUTPUT :PIANOC-:TUNEBASE+:Y+NTH :LASTSCALE "0 2 4 5 7 9 11"
500 MAKE "LASTSCALE" :X
502 MAKE "X" :X+:SCALEBASE
505 IF :X<1 MAKE "X" :X+COUNT :SCALE MAKE "Y" :Y-12 GO 505
510 MAKE "Z" :SCALE
520 IF :X=1 OUTPUT :Y+FIRST :Z
530 MAKE "Z" BUTFIRST :Z
535 MAKE "X" :X-1
540 IF EMPTYP :Z MAKE "Y" :Y+12 GO 510
550 GO 520
END

TO TEMPO :XX
10 LOCAL "X" "DOT"
20 MAKE "X" POSITION FIRST :XX "S E Q H W"
30 IF :X=0 GO 80
40 MAKE "X" NTH :X "1 2 4 8 16"
50 MAKE "DOT" :X/2
60 MAKE "XX" BUTFIRST :XX
70 IF EMPTYP :XX OUTPUT :X
71 IF "."=FIRST :XX MAKE "X" :X+:DOT MAKE "DOT" :DOT/2 GO 60
80 TYPE :XX EXIT " IS NOT A DURATION"
END

TO PLAY :X
5 LOCAL "Y" "Z" "PLNEXT"
10 IF WORDP :X MAKE "X" BUTFIRST SENTENCE 1 :X
12 IF EMPTYP FIRST :X GO 405
15 IF "<"=FIRST FIRST :X GO 500
20 PLAYNOTE INTERPRET FIRST :X
405 MAKE "X" BUTFIRST :X
410 IF EMPTYP :X STOP
420 GO 15
500 MAKE "Y" BUTFIRST SENTENCE 1 BUTFIRST FIRST :X
510 MAKE "X" BUTFIRST :X
520 IF ">"=LAST FIRST :X MAKE "PLNEXT" SENTENCE :Y BUTLAST FIRST :X GO 600
530 MAKE "Y" SENTENCE :Y FIRST :X GO 510
600 MAKE "X" BUTFIRST :X
610 CHORUS "PLNEXT PLNEXT PLN¯∂* °˘ì¢ÿ©"
62ˆ#œAˆåXEND
Ò¢™OAPLAYNOTE :˚#E1a LOCA˘àSÉVEINST"
1ˆ®$∆Aˆ/£I•ST BU˙ë§“ßT :Y EXIT "DURATION LESS THAN 1 NOT ALLOWED"
22 IF EMPTYP BUTFIRST BUTFIRST :Y GO 30
24 MAKE "SAVE˘3©‘E :INS˙î™Õã˘’äeˆ»&¡óE "IN˙u)UõENT" ˘êi‘A:Y
30 IF NOT :INSTRUMENT="DRUM" GO 90
40 IF 4>FIRST :Y GO 90
60 MAKE "Z" 1 GO 100
90 MAKE "Z" FIRST :Y
100 MAKE "Y" FIRST BUTFIRST :Y
105 MBUFPUT :Z
108 IF :Z<4 GO 130ÓÒLX9AMAKE "LASTPITCH" :Z
110 IF :INSTRUMENT="LEGATO" GO 200
120 IF :INSTRUMENT="SLUR" GOÙÿ0130 ˘∞™∆ù¯∂* u˘’ß…á¯¥’:≥ GO 4ˆäe00 IFÙ¨ΩeÙaUç˘—lTA:NVOI¯qi™eÙÁ†i00
3ˆMÖUFNEX˙àN≠˘Úa≈ßÒ¢ô±aÙc uY=1 G˘Ë0a
320Ù`ÀãÙ¨¢A˜VV±AGO 10ˆ£E4aˆ$∆ANOT E˘¥*Y°Ù©¡≠EINST MAKE "INSTRUME˘’ u˙pkEì˘‘ÍEND

TO CHORUS :XÓÒLX ôOCAL "MAX" "BUF" "Y"
15 MAKE "Y" 1
20 MAKE "MAX" MBUFCOUNT
30 ˘∞e≈A"BUF" :MAX-1
40 IF EMPTYP :X GO 20ˆE4kÙc uX="VO˘0‚”EÙ&A≥Ù$IùG "V"&:Y MAKE "Y" :YılPGüÙÿˆ¨Dü FIRST :X
60 MAKE "X" BUTFIRST :X
70 MAKE "MAX" MAXIMUM :MAX MBUFCOUNT
90 MBUFSTART
100 MAKE "BUF" :BUF+1
110 MBUFNEXT :BUF
120 GO 40
200 MBUFSTART
210 MBUFNEXT ((:MAX-1)/4)*4
END

TO PLNEXT
10 LOCAL "X" "Z"
20 IF EMPTYP :PLNEXT STOP
25 IF EMPTYP FIRST :PLNEXT MAKE "PLNEXT" BUTFIRST :PLNEXT GO 20
30 IF "("=FIRST FIRST :PLNEXT MAKE "X" BUTLAST SENTENCE BUTFIRST FIRST :PLNEXT 1 GO 100
40 PLAYNOTE INTERPRET FIRST :PLNEXT MAKE "PLNEXT" BUTFIRST :PLNEXT STOP
100 MAKE "PLNEXT" BUTFIRST :PLNEXT
110 IF EMPTYP :PLNEXT GO 195
120 IF ")"=LAST FIRST :PLNEXT MAKE "X" SENTENCE :X BUTLAST FIRST :PLNEXT GO 190
130 MAKE "X" SENTENCE :X FIRST :PLNEXT MAKE "PLNEXT" BUTFIRST :PLNEXT GO 110
190 MAKE "PLNEXT" BUTFIRST :PLNEXT
195 PLAY :X
200 STOP
END

TO PLAYT :P :D
10 LOCAL "X"
20 IF WORDP :P MAKE "P" BUTFIRST SENTENCE 1 :P
30 IF WORDP :D MAKE "D" BUTFIRST SENTENCE 1 :D
40 IF EMPTYP :P STOP
50 IF EMPTYP :D STOP
55 IF EMPTYP FIRST :P MAKE "P" BUTFIRST :P GO 55
58 IF EMPTYP FIRST :D MAKE "D" BUTFIRST :D GO 58
60 IF NUMBERP FIRST :P MAKE "X" :TUNEBASE+FIRST :P GO 80
70 MAKE "X" FIRST INTERPRET FIRST :P
80 PLAYNOTE SENTENCE :X BUTFIRST INTERPRET FIRST :D
90 MAKE "P" BUTFIRST :P
100 MAKE "D" BUTFIRST :D
110 GO 40
END

TO PLAY4 :V1 :V2 :V3 :V4
10 CHORUS "VOICES"
END

TO NVOICES :N
10 MAKE "NVOICES" :N
20 VOICES :N
END

˙ì–S©ARTMUSIC
ˆ,MÖ˙±§ŒìT
20Ù´Oì¯qi†i
30 ˘∞™∆á˘ë`“ÒM õAKE "˙ïgEÖ¯4‚¢A23
50 MAKE "SCALEBASE" 0
60 MAKE "INSTRUMENT" "LEGATO"
70 MAKE "FLATS" ""
80 MAKE "SHARPS" ""
90 MAK¯®LÉ˙u(I©CH" 23
10ˆ&¡óE "LA˙u"U•ATIONÙH110 M¯2‚†ESCALE" "0 2 4 5 7 9 11"
120 MAKE "PIANOC" 23
END

TO VOICE :N
10 MBUFSTART
20 MBUFNEXT :N-1
END

TO EM
10 MBUFOUT
20 MBUFCLEAR
END

TO SETTEMPO
100 MAKE "SR" "2 1 1 1 1 1 1"
200 MAKE "TR" "1 7"
300 MAKE "BR" 8
END

TO BACH
100
150 MAKE "B¯4ß"AˆMFäc˜PMÉKE "BARN" :BARN+1
182 IF :BAR˘œY≥A¯Û–4a0
190 MAKE "CHORD" ˙í$ŒèÙÁ“â "BARÙHBÉRN
300 CHORUS "SOP TEN BASS"ÓÒLÿ1A˙§Œ© :BARN
350 GO 181
ˆå á˘ÈUß "SOPˆH*EùˆH!Aß˙lëˆ¨ °LAY "˜ä°Øcˆ»"†èÙﬂ"ENDÓÒCETü DUBBLE :X˚E1a OUTPUT SENTENCE :XX :XX
END

TO SOP2
10 ˙ ŸAÙT¢”©/2 *F/1 *AÙ–FAC *A C *A *F *A *F *D *F *D REST RE˙uGA¯H"*ç* D* ¯H"*AB G BÙFAE D"
ENDÓÒCETüÙ"ŒeÒ¢ò∞APLAY ÙT¢”©/1 *C/15 REST/1Ù
ïB_15"
END
Ò¢™OA¯Pi”eÒ¢ò∞A˙ ŸA"*C/16 *C"
END

TO SOP
1
10 MAKE "WCHORD" BUTFIRST :CHORD
20 MAKE "WCHORD" BUTFIRST :WCHORD
30 PLAYT DUBBLE SENTENCE "REST" SENTENCE :WCHORD :WCHORD SENTENCE :SR :SR
END

TO TEN
1
10 MAKE "WCHORD" BUTFIRST :CHORD
20 MAKE "WCHORD" FIRST :WCHORD
30 PLAYT DUBBLE SENTENCE "REST" :WCHORD SENTENCE :TR :TR
END

TO BASS
1
10 PLAYT DUBBLE FIRST :CHORD SENTENCE :BR :BR
END

TO INITIALIZEBACH
10 MAKE "BARN" 0
20 MAKE "BARN" :BARN+1
30 TEST :BARN=33
40 IFTRUE STOP
50 PRINT :BARN
60 PRINT ""
70 PRINT ""
80 MAKE WORD "BAR" :BARN REQUEST
90 GO 20
END

TO EDITTUNE
10 MAKE WORD "BAR" REQUEST REQUEST
20 PRINT ""
30 GO 10
END

TO FOO :XX
10 PLAYT :BAR28 :XX
END

TO BACH2
100 SETTEMPO
150 MAKE "BARN" 0
181 MAKE "BARN" :BARN+1
182 IF :BARN=25 STOP
190 MAKE "CHORD" THING WORD "BAR" :BARN
300 CHORUS "SOP TEN BASS"
301 PRINT :BARN
350 GO 181
END
MAKETUNEBASE 23
MAKEZ 11
MAKELASTPITCH 34
MAKELASTDURATION 1
MAKELASTSCALE 0
MAKEFLATS 
MAKESHARPS 
MAKEPIANOC 23
MAKESCALEBASE 0
MAKESCALE 0 2 4 5 7 9 11
MAKEINSTRUMENT LEGATO
MAKENVOICES 4
MAKEBARN 33
MAKECHORD *C *C *G *B$ E
MAKEWCHORD *C
MAKESR 2 1 1 1 1 1 1
MAKETR 1 7
MAKEBR 8
MAKEBAR28 **G *E$ *A C F#
MAKEBAR˘»A0
MAKE¯Pi1)Ù!†ã G C*ÙUÒS`ÀãBAR2Úà
CAD A D* F*Ò¢¶¡óEBARˆeUB D G D* F*
M¯2‚îÖAR4 C E ¯Ë!™AE*
MAKEBAR5 C E A E* A*
MAKEBAR6 C D F# A D*
MAKEBAR7 *B D G D* G*
MAKEBAR8 Úä° á E G ¯jäMAKE¯Pi9) *A C E G C*ÓÒS`ÀãBAR10 *D *A D F# C*
MAKEBAR11 *G *B D G B
MAKEBAR12 *G *B$ E G C*#
MAKEBAR13 *F *A D A D*
˘∞e≈)BAR14 *F *A$ D F B
MAKEBAR15 *E *G C G C*
MAKEBAR1ˆ≈UE *F *A C F
MAKEBAR17 *D *F *A C F
MAKEBAR18 **G *D *G *B F
MAKEBARˆ.J )ıP–*ã *G C E
MAKEBAR20 *C *G *B$ C E
M¯2‚îÖ¯4ô1) **F *F *A C EÚÉEMÉKEBAR22 **F#Ù
°†UA C EÙÖäõAKEBAR23Ù*É$ *F *B C ¯Öäõ¯2‚îÖAR24 **G *F *¯ËBAD
M¯2‚îÖAR25Ù*èÙ
¢†UG C EÚÉEMÉ˘qJBÉ˙LõA**G ıQ*è C F
MAK¯•!A•ˆM  )**G *D *G *B F
MAKEBAR29 **G *E *G ¯h#îMAKEBAR3ˆUıQ–*âÙ
£†á F
MAKEBAR31 **G *D *G *BÙä˘∞e≈)BAR32Úà
*áÙ
°†U¯ËBI E
˘∞e≈)FOO 10 1ˆ∞Aˆ,1aÚÉEMÉKEBAR 28 **¯ËEI *A C F#

