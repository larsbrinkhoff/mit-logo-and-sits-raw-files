Ò¢Üä©O MEMBERP ˜V:ô
10 IF EMPTYP :L OUTPUT "FALSE"
20 IF :X=FIRST :L OUTPUT "TRUE"
30 MAKE "L" BUTFIRST :L GO 10
END

TO POSITION :X :LIST
10 LOCAL "Y"
20 MAKE "Y" 1
30 IF EMPTYP :LIST OUTPUT 0
40 IF :X=FIRST :LIST OUTPUT :Y
50 MAKE "Y" :Y+1
60 MAKE "LIST" BUTFIRST :LIST
70 GO 30
END

TO NTH :X :LIST
10 IF EMPTYP :LIST EXIT "LIST TOO SHORT"
20 IF :X=1 OUTPUT FIRST :LIST
30 MAKE "LIST" BUTFIRST :LIST
40 MAKE "X" :X-1
50 GO 10
END

TO INTERPRET :XX
10 LOCAL "X" "Y" "Z"
20 MAKE "X" :XX
25 MAKE "Y" :TUNEBASE
30 IF NUMBERP :X GO 1010
40 IF "*"=FIRST :X MAKE "Y" :Y-12 MAKE "X" BUTFIRST :X GO 40
50 IF EMPTYP :X GO 500
60 IF "/"=FIRST :X MAKE "X" BUTFIRST :X GO 500
70 IF "*"=FIRST :X MAKE "Y" :Y+12 MAKE "X" BUTFIRST :X GO 50
80 MAKE "Z" :Z&FIRST :X
90 MAKE "X" BUTFIRST :X
100 GO 50
500 IF NUMBERP :Z MAKE "Y" :Z+:Y GO 1000
505 IF EMPTYP :Z MAKE "Y" :LASTPITCH GO 1000
510 IF ":"=FIRST :Z MAKE "Y" :Y+SCALE BUTFIRST :Z GO 1000
520 IF "+"=LAST :Z MAKE "Y" :Y-:TUNEBASE+:LASTPITCH+BUTLAST :Z GO 1000
530 IF "-"=LAST :Z MAKE "Y" :Y-:TUNEBASE+:LASTPITCH-BUTLAST :Z GO 1000
531 IF :Z="REST" MAKE "Y" 0 GO 1000
532 IF :Z="BOOM" MAKE "Y" 1 GO 1000
533 IF :Z="GRITCH" MAKE "Y" 2 GO 1000
540 MAKE "Y" :Y+SCALE :Z
1000 IF EMPTYP :X MAKE "X" :LASTDURATION
1010 IF NUMBERP :X MAKE "LASTDURATION" :X OUTPUT SE˘’"ŒáE :Y :X
1020 MAKE "Z" ""
103ˆ$∆AEMPTYP :X GO 2000
1040 IF ","=FIRST :X MAKE ÙV ÖUTFIRST :X GO 2000
1050 MAKE ÙVë uZ&FIRST :X MAKEÙ¨"ABUTFIRST :X GO ˆ,∞2000 IF NOT NU˘∞¢“° :Z MAKE "˚HêTãMPO :Z
2005 MAKE "LASTDURATIO˘»ê:µ
2010 IF EMPTYP :X OUTPUT SEN˙ëgCã :Y :Z
2020 OUTPUT (SENTENCE :Y :Z :X)
ENDÓÒCETü SCALE :XX
10 LOCAL "X" "Y" "˚Hê"ùAT"
20 MAKE "Y" 0
25 MAKE "X" :XX
30 IF "#ÙOfAßT :X MAKE "Y" :Y+1 MAKE "X" BU˙ì ”© :X GO 30
40 IF "$"=LAST :X MAKE "Y" :Y-1 MA˘qP"±" BUTLAST :X GO 40
45 IF "%"=˘êi‘A:X MAKE "NAT" 1Ù`Àã "X" BUTLA˙u:±
50 IF NUMBERP :X GO 500
55 ˘1ê"W"=LAST :X MAKE "X" :˘êi‘ßCALE+¯UjLÉ˙u:± GO 500
56 IF "-"=LAST :X MAK¯®XE :LASTSCALE-BUTLAST ˜VGü 500
70 MAKE "LASTSCALE" POSITION :X "C D E F G A B"
75 IF :LASTSCALE=0 P˙RgTA˜V, ãXIT " IS NOT IN THE SCALE"
80Ùc c=:NAT GO 100
82 IF ˘”Í uY=0 GO 100
85 IF MEMBERP :X :FLATS MAKE "Y" -1
90 IF MEMBERP :X :SHARPS MAKE "Y" 1
100 OUTPUT :PIANOC-:TUNEBASE+:Y+NTH :LASTSCALE "0 2 4 5 7 9 11"
500 ˘∞e≈AÙS ”©SCALE" :X
502 MAKE "X" :X+:SC¯3"¬ÉSE
505 IF :X<1 MAKE "X" :X+COUNT :˙p‡Ãã MAKE "Y" :Y-12 GO 505
510 MA˘qP"µ" :SCALE
520 IF :X=1 OUTPUT :Y+FIRST :Z
530 MAKE "Z" ¯UjFìRST :˚CE5g5 MAKE "X"Ù¨-c
540 IF EMPTYPÙ≠ õAKE "Y" :Y+12 G˘Ë±a
550 GO 520
E˘—äTO TEMPO :XX
ˆ,LüCAL "X" "DOT"
20 MAKE "X" POSITION FIRST :XX "S E Q H W"
30 IF :X=0 GO 80
40 MAKE "X" NTH :X "1 2 4 8 16"
ˆ¨MÉKE "DOT" :X/2
60 MAKE "XX" BUTFIRST :XX
70 IF EMPTYP :XX OUTPUT :X
71 IF "."=FIRST :XX MAKE "X" :˚
›DüT MAKE "DO˙àê:âOT/2 GO 60
80 TYPE :XX EXIT " IS NOT A DURATION"
END

TO PLAY :X
5 LOCAL "Y" "Z" "PLNEXT"
10 IF WORDP :X MAKE "X" BUTFI˙TÍ ßENTENCE 1 :X
12 IF EMPTYP FIR˙u:± GO 405
15 IF "<"=FIRST FIRSTÙ¨ èO 500Ò¢ô0APLAYNOTE INTERP˙Qj çIRST :X
405 MAKE "X" BUTFIRST :X
410 IF EMP˙ñh uX STOP
420 GO ˆ-Fäk00 MA˘qP"≥" BUTFIRSTÙ‚Œ©ENCE 1 BUTFIRST FIRST :X
510 MAKE "X" BUTFIRST :X
520 IF ">"=LAST FIRST :X MAKE "PLNEXT" SENTENCE :Y BUTLAST FIRST :X GO 600
530 MAKE "Y" SENTENCE :Y FIRST :X GO 510
600 MAKE "X" BUTFIRST :X
610 CHORUS "PLNEXT PLNEXT PLNEXT PLNEXT"
620 GO 410
END

TO PLAYNOTE :Y
10 LOCAL "SAVEINST"
15 IF 1>FIR˙uB´TFIRST :Y EXIT "DURATION LESS THAN ˆ('O© ALLOWED"
22 IF EMPTYP BUTFIR˙uB´TFIRST :Y GO 30
24 ˘∞e≈A"SAVEINST" :INSTRUMENT
26 MAKE "INSTRUMENT" LAST :Y
30 IF NOT :INSTRUMENT="DRUM" GO 90
40 IF 4>FIRST :Y GO 90
60 MAKE "Z" 1 GO 100
90 MAKE "Z" FIRST :Y
100 MAKE "Y" FIRST BUTFIRST :Y
105 MBUFPUT :Z
108 IF :Z<4 GO 130
109 MAKE ÙS ”©˙jCë" :Z
110 IF :INSTRUMENT="LEGA˙ì— èO 200
120 IF :INSTR˙≥bŒ©="SLUR" GO 300
130 ˘∞™∆ùEXT :NVOICES*:YÙÁ†i00
200 IF :Y=2 MBUFNEXT :NVOI¯qi™e GO 400
300 MBUFNEX˙àN≠OICESÒ¢ô±aÙc uY=1 GO 400
320 MAKE "Y" :Y-1 ¯Û–1a5
40ˆ$∆ANOT EMPTYPÙ©¡≠EINSTÙ`Àã "INS˙î™ÕãNT" :˙pkEì˘‘Í¯≥¢
TO CHORUS :X
10 LOCAL "MAX" "BUF" "Y"Ò¢òµAMAKE "Y" 1
20 MAKE ÙS`ÿE MBUF¯sÍŒ©Ò¢ô∞AMAKE "BUF" :MAX-1
40 IF EMPTY˙XAGO 200
45 IF :X="VO˘0‚”E PLAYÙ$IùG "V"&:Y MAKE "˚(ê:≥ılPGü 70
50 DOÙ§“ß˙àX60 M¯2‚†EX" BUTFIRST :X
70 MAKE "MAX" ˘∞lIõUM :MAX MBUFCOUNT
9ˆ&¬´FSTAR˙ÉE1aˆ&¡óE "BUF" :BUF+1
110 MBUFNEXT :¯Uc120 G˘Ë0200 MBUFS˙êiT210 MBUFNEXT (ı¶¡±ı¨TØi)*4
¯≥¢Ò¢™OAPLNEX˙ÉE1a LOCAL "X" "Z"
20 IF EMPTYP :˙'E±T STOP
25 IF EMPTYPÙ§“ßT :PL˘—lTA˘∞e≈A"PLNEXT" BUTFIRST :PLNEXT GO 2ˆE3a IF "("=FIRST FIRST ˜T&NãXT MAKE "X" BUT˘êi‘A˙qgTãNCE BUTFIRST FIRST :PLNEXT 1 GO 100
40 PLAYNOTE I˘’"“°RET FIRST :PLNEXT MA˘qP"°LNEXTÙH!U©¯“iS© :PLNEXT STOP
100 MAKE "PLNEX˙àêB´TFIRST :PLNEXT
110 ˘1êEõPTYP ˜T&NãXT GOÙ\µ120 ˘1ê"S"=LAS˙à#I•˙u:°LNEXT MAKE "X" ˙qgTãNCE :X BUTLAST FIRST :PLNEXT G˘Ëπa
130 MAKE "X" SENTE˘–‚†uX FIR˙u:°˘ì¢ÿ© MAKE "PLNEXT" BUTFIRST :PLNEX˙à#œA110
190 MAKE "PLNEX˙àêB´TFIRST :PLNEXTÓÒL\µAPLAY ˜VäeˆS©OP
E˘—äTO P˘êl‘A:P :DÒ¢ò∞ALOCAL "X"
20 IF WORDP :P MAKE "P" BUTFIRST SENTENCE 1 :P
30 IF WORDP :D MAKE "D" BUTFIRST SENTENCE 1 :D
40 IF EMPTYP :P STOP
50 IF EMPTYP :D STOP
55 IF EMPTYP FIRST :P MAKE "P" BUTFIRST :P GO 55
58 IF EMPTYP FIRST :D MAKE "D" BUTFIRST :D GO 58
60 IF NUMBERP FIRST :P MAKE "X" :TUNEBASE+FIRST :P GO 80
70 MAKE "X" FIRST INTERPRET FIRST :P
80 PLAYNOTE SENTENCE :X BUTFIRST INTERPRET FIRST :D
90 MAKE "P" BUTFIRST :P
100 MAKE "D" BUTFIRST :D
110 GO 40
END

TO PLAY4 :V1 :V2 :V3 :V4
10 CHORUS "VOICES"
END

TO NVOICES :N
10 MAKE "NVOICES" :N
20 VOICES :N
END

TO STARTMUSIC
10 MBUFINIT
20 NVOICES 4
30 MBUFCLEAR
40 MAKE "TUNEBASE" 23
50 MAKE "SCALEBASE" 0
60 MAKE "INSTRUMENT" "LEGATO"
70 MAKE "FLATS" ""
80 MAKE "SHARPS" ""
90 MAKE "LASTPITCH" 23
100 MAKE "LASTDURATION" 2
110 MAKE "SCALE" "0 2 4 5 7 9 11"
120 MAKE "PIANOC" 23
END

TO VOICE :N
10 MBUFSTART
20 MBUFNEXT :N-1
END

TO EM
10 MBUFOUT
20 MBUFCLEAR
END

TO SETTEMPO
100 MAKE "SR" "2 1 1 1 1 1 1"
200 MAKE "TR" "1 7"
300 MAKE "BR" 8
END

TO BACH
100 SETTEMPO
150 MAKE "BARN" 0
181 MAKE "BARN" :BARN+1
182 IF :BARN=33 GO 400
190 MAKE "CHORD" THING WORD "BAR" :BARN
300 CHORUS "SOP TEN BASS"
301 PRINT :BARN
350 GO 181
400 CHORUS "SOP2 TEN2 BASS2"
500 PLAY "<*C/16 E G C>"
END

TO DUBBLE :XX
10 OUTPUT SENTENCE :XX :XX
END

TO SOP2
10 PLAY "REST/2 *F/1 *A C F C *A C *A *F *A *F *D *F *D REST REST G B D*F* D* B D* B G B D F E D"
END

TO TEN2
10 PLAY "REST/1 *C/15 REST/1 **B/15"
END

TO BASS2
10 PLAY "*C/16 *C"
END

TO SOP
1
10 MAKE "WCHORD" BUTFIRST :CHORD
20 MAKE "WCHORD" BUTFIRST :WCHORD
30 PLAYT DUBBLE SENTENCE "REST" SENTENCE :WCHORD :WCHORD SENTENCE :SR :SR
END

TO TEN
1
10 MAKE "WCHORD" BUTFIRST :CHORD
20 MAKE "WCHORD" FIRST :WCHORD
30 PLAYT DUBBLE SENTENCE "REST" :WCHORD SENTENCE :TR :TR
END

TO BASS
1
10 PLAYT DUBBLE FIRST :CHORD SENTENCE :BR :BR
END

TO INITIALIZEBACH
10 MAKE "BARN" 0
20 MAKE "BARN" :BARN+1
30 TEST :BARN=33
40 IFTRUE STOP
50 PRINT :BARN
60 PRINT ""
70 PRINT ""
80 MAKE WORD "BAR" :BARN REQUEST
90 GO 20
END

TO EDITTUNE
10 MAKE WORD "BAR" REQUEST REQUEST
20 PRINT ""
30 GO 10
END

TO FOO :XX
10 PLAYT :BAR28 :XX
END
MAKETUNEBASE 23
MAKEZ 11
MAKELASTPITCH 34
MAKELASTDURATION 1
MAKELASTSCALE 0
MAKEFLATS 
MAKESHARPS 
MAKEPIANOC 23
MAKESCALEBASE 0
MAKESCALE 0 2 4 5 7 9 11
MAKEINSTRUMENT LEGATO
MAKENVOICES 4
MAKEBARN 33
MAKECHORD *C *C *G *B$ E
MAKEWCHORD *C
MAKESR 2 1 1 1 1 1 1
MAKETR 1 7
MAKEBR 8
MAKEBARN  0
MAKEBAR1 C E G C* E*
MAKEBAR2 C D A D* F*
MAKEBAR3 *B D G D* F*
MAKEBAR4 C E G C* E*
MAKEBAR5 C E A E* A*
MAKEBAR6 C D F# A D*
MAKEBAR7 *B D G D* G*
MAKEBAR8 *B C E G C*
MAKEBAR9 *A C E G C*
MAKEBAR10 *D *A D F# C*
MAKEBAR11 *G *B D G B
MAKEBAR12 *G *B$ E G C*#
MAKEBAR13 *F *A D A D*
MAKEBAR14 *F *A$ D F B
MAKEBAR15 *E *G C G C*
MAKEBAR16 *E *F *A C F
MAKEBAR17 *D *F *A C F
MAKEBAR18 **G *D *G *B F
MAKEBAR19 *C *E *G C E
MAKEBAR20 *C *G *B$ C E
MAKEBAR21 **F *F *A C E
MAKEBAR22 **F# *C *A C E$
MAKEBAR23 **A$ *F *B C D
MAKEBAR24 **G *F *G *B D
MAKEBAR25 **G *E *G C E
MAKEBAR26 **G *D *G C F
MAKEBAR27 **G *D *G *B F
MAKEBAR28 **G *E$ *A C F#
MAKEBAR29 **G *E *G C G
MAKEBAR30 **G *D *G C F
MAKEBAR31 **G *D *G *B F
MAKEBAR32 *C *C *G *B$ E
MAKEFOO 10 10 10 10 10
MAKEBAR 28 **G *E$ *A C F#

